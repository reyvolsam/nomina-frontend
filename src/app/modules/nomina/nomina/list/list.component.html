<app-header></app-header>

<div class="AllDashboard animated fadeIn">

  <div class="BreadCs">
    <h5>Lista de Pagos</h5>
  </div>
  <!--BreadCs-->

  <div class="Dashboard scroller">

    <div class="row">
      <div class="col-sm-3">
        <button class="btn btn-gv" (click)="open()"><i class="material-icons" style="vertical-align: middle;">add</i>
          Crear Pago</button>
      </div>


      <div class="col-sm-3">
        <button type="button" class="btn  btn-outline-primary" (click)="isCollapsed = !isCollapsed"
          [attr.aria-expanded]="!isCollapsed" aria-controls="collapseFilter">Busqueda Avanzada</button>
      </div>
    </div>
    <!--col-sm-3-->

    <div class="clearfix"></div>
    <!--/clearfix-->
    <br />

    <div id="collapseFilter mb-3 mt-3" [ngbCollapse]="isCollapsed">
      <div class="card card-body">
        <form class="row" [formGroup]="formSearch">
          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Fecha</label>
              <input type="text" class="form-control form-control-sm" placeholder="Periodo" maxlength="105"
                formControlName="date" />
            </div>
            <!--/form-group-->
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Periodo</label>
              <input type="text" class="form-control form-control-sm" maxlength="100" placeholder="Periodo"
                formControlName="period" />
            </div>
            <!--/form-group-->
          </div>

          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Obra</label>
              <input type="text" class="form-control form-control-sm" maxlength="100" placeholder="Obra"
                formControlName="obra" />
            </div>
            <!--/form-group-->
          </div>

          <div class="col-3 d-flex">
            <div class="float-right align-self-center">
              <button type="button" class="btn btn-success" (click)="search()">Buscar</button>
              <button type="button" class="btn btn-danger ml-1" (click)="cleanSearch()">Mostrar todos</button>
            </div>

            <!--/col-sm-4-->
          </div>

        </form>
        <!--/row-->

      </div>
      <!--/card-->
    </div>
    <!-- form de busqueda -->

    <div class="col-sm-12 mt-2">

      <table class="table">
        <thead>
          <th>Fecha</th>
          <th>Empresa</th>
          <th>Periodo</th>
          <th>Obra</th>
          <th>Acciones</th>
        </thead>
        <tbody *ngFor="let l of list; let i = index">
          <tr>
            <td>{{ l.date }} </td>
            <td>{{ l.company?.name}}</td>
            <td>{{ l.period }}</td>
            <td>{{ l.obra }}</td>
            <td>
              <button type="button" 
                      class="btn btn-primary btn-sm"
                      (click)="downloadFiles( l.nomina_dispersion )">
                <i class="fa fa-cloud-download"></i>
              </button>
              <button class="btn btn-info btn-sm" (click)="edit(i)"><i class="fa fa-edit"></i></button>
              <button class="btn btn-danger btn-sm" (click)="delete(i)"><i class="fa fa-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="loader == true" class="text-center">
        <div class="spinner-border" role="status">
          <span class="sr-only">Cargando...</span>
        </div>
        <!--/spinner-border-->
      </div>
      <!--/text-center-->

    </div>
    <!--/col-sm-12-->


  </div>
  <!--/Dashboard-->

</div>
<!--/AllDashboard-->
