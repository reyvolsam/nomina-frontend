<app-header></app-header>

<div class="AllDashboard animated fadeIn">

  <div class="BreadCs">
    <h5>Lista CFDI de Nomina</h5>
  </div>
  <!--BreadCs-->

  <div class="Dashboard scroller">

    <div class="row">
      <div class="col-sm-3">
        <button class="btn btn-gv" (click)="openModal()">
          <i class="material-icons" style="vertical-align: middle;">add</i>
          Crear CFDI de Nomina
        </button>
      </div>

      <div class="col-sm-3">
        <button type="button" class="btn  btn-outline-primary" (click)="isCollapsed = !isCollapsed"
          [attr.aria-expanded]="!isCollapsed" aria-controls="collapseFilter">Busqueda Avanzada</button>
      </div>
    </div>
    <!--col-sm-3-->

    <div class="clearfix"></div>
    <!--/clearfix-->
    <br />

    <div id="collapseFilter mb-3" [ngbCollapse]="isCollapsed">
      <div class="card card-body">
        <form class="row" [formGroup]="form">
          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Fecha</label>
              <input type="text" class="form-control form-control-sm" placeholder="Periodo" maxlength="105"
                formControlName="date" />
            </div>
            <!--/form-group-->
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Periodo</label>
              <input type="text" class="form-control form-control-sm" maxlength="100" placeholder="Periodo"
                formControlName="period" />
            </div>
            <!--/form-group-->
          </div>

          <div class="col-sm-3">
            <div class="form-group">
              <label for="">Obra</label>
              <input type="text" class="form-control form-control-sm" maxlength="100" placeholder="Obra"
                formControlName="obra" />
            </div>
            <!--/form-group-->
          </div>

          <div class="col-3 d-flex">
            <div class="float-right align-self-center">
              <button type="button" class="btn btn-success" (click)="search()">Buscar</button>
              <button type="button" class="btn btn-danger ml-1" (click)="cleanSearch()">Mostrar todos</button>
            </div>

            <!--/col-sm-4-->
          </div>

        </form>
        <!--/row-->

      </div>
      <!--/card-->
    </div>

    <div class="col-sm-12">

      <table class="table">
        <thead>
          <th>Fecha</th>
          <th>Empresa</th>
          <th>Periodo</th>
          <th>Obra</th>
          <th>Acciones</th>
        </thead>
        <tbody>
          <tr *ngFor="let c of cfdiList; let i = index">
            <td>{{ c.date }} </td>
            <td>{{c.company?.name}}</td>
            <td>{{ c.period }}</td>
            <td>{{c.obra}}</td>
            <td>
              <button type="button"
                      class="btn btn-primary btn-sm mr-1"
                      (click)="downloadFiles(c)">
                      <i class="fa fa-cloud-download" aria-hidden="true"></i>
              </button>
              <button class="btn btn-info btn-sm" (click)="editCfdi(c)"><i class="fa fa-edit"></i></button>
              <button class="btn btn-danger btn-sm ml-2" (click)="deleteCfdi(i, c.id)"><i
                  class="fa fa-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="loader==true" class="text-center">
        <div class="spinner-border" role="status">
          <span class="sr-only">Cargando...</span>
        </div>
        <!--/spinner-border-->
      </div>
      <!--/text-center-->

    </div>
    <!--/col-sm-12-->


  </div>
  <!--/Dashboard-->

</div>
<!--/AllDashboard-->
